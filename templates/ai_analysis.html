{% extends "base.html" %}
{% block content %}

<style>
/* Restaurant-themed background */
body {
  background: linear-gradient(rgba(0, 0, 0, 0.85), rgba(0, 0, 0, 0.85)), 
              url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1950&q=80');
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  background-repeat: no-repeat;
}

/* Card animations */
.card {
  border: 1px solid rgba(255, 215, 0, 0.2);
  background: rgba(18, 18, 18, 0.95) !important;
  backdrop-filter: blur(10px);
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  animation: fadeInUp 0.6s ease-out;
  overflow: hidden;
  position: relative;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
  transition: left 0.7s ease;
}

.card:hover::before {
  left: 100%;
}

.card:hover {
  transform: translateY(-8px) scale(1.02);
  border-color: rgba(255, 215, 0, 0.5);
  box-shadow: 0 15px 30px rgba(255, 215, 0, 0.15);
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Stagger animation delays */
.card:nth-child(1) { animation-delay: 0.1s; }
.card:nth-child(2) { animation-delay: 0.2s; }
.card:nth-child(3) { animation-delay: 0.3s; }
.card:nth-child(4) { animation-delay: 0.4s; }

/* Summary cards specific styling */
.summary-card {
  background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(0,0,0,0.9)) !important;
  border-left: 4px solid #ffd700;
  animation: glowPulse 2s infinite;
}

@keyframes glowPulse {
  0% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.2); }
  50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.4); }
  100% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.2); }
}

/* Chart container animations */
.chart-container {
  position: relative;
  height: 250px;
  width: 100%;
  animation: chartPop 0.8s ease-out;
}

@keyframes chartPop {
  0% { transform: scale(0.9); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}

/* Header styling */
.page-header {
  text-align: center;
  margin-bottom: 2rem;
  padding: 1.5rem;
  background: rgba(0, 0, 0, 0.6);
  border-radius: 15px;
  backdrop-filter: blur(5px);
  border: 1px solid rgba(255, 215, 0, 0.3);
  animation: slideInDown 0.8s ease-out;
}

@keyframes slideInDown {
  from {
    transform: translateY(-50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Card header gradients */
.card-header {
  background: linear-gradient(135deg, #000, #1a1a1a) !important;
  border-bottom: 2px solid #ffd700 !important;
  font-weight: 600;
  letter-spacing: 1px;
}

/* Value animations */
.value-pulse {
  animation: valueGlow 2s ease-in-out infinite;
}

@keyframes valueGlow {
  0%, 100% { text-shadow: 0 0 10px currentColor; }
  50% { text-shadow: 0 0 20px currentColor; }
}

/* Restaurant-themed decorative elements */
.card-footer {
  background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.1), transparent);
  height: 2px;
  width: 100%;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: #1a1a1a;
}

::-webkit-scrollbar-thumb {
  background: #ffd700;
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: #ffed4a;
}
</style>

<div class="page-header">
  <h2 class="text-warning mb-2">üçΩÔ∏è Restaurant AI Business Forecast</h2>
  <p class="text-light">Smart insights for your culinary success</p>
</div>

<!-- Summary Cards Row with Restaurant Theme -->
<div class="row mb-4 g-4">
  <div class="col-md-4">
    <div class="card summary-card h-100">
      <div class="card-body text-center">
        <h5 class="text-warning mb-3">üçï Predicted Revenue</h5>
        <h3 class="text-success value-pulse">‚Çπ{{ predicted_revenue }}</h3>
        <small class="text-muted">Next 30 days forecast</small>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card summary-card h-100">
      <div class="card-body text-center">
        <h5 class="text-warning mb-3">üí∞ Predicted Expense</h5>
        <h3 class="text-danger value-pulse">‚Çπ{{ predicted_expense }}</h3>
        <small class="text-muted">Operational costs</small>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="card summary-card h-100">
      <div class="card-body text-center">
        <h5 class="text-warning mb-3">üìä Predicted Net Profit</h5>
        <h3 class="text-info value-pulse">‚Çπ{{ predicted_profit }}</h3>
        <small class="text-muted">Bottom line forecast</small>
      </div>
    </div>
  </div>
</div>

<!-- 2x2 Grid for Charts -->
<div class="row g-4 mb-4">
  <!-- Monthly Forecast -->
  <div class="col-md-6">
    <div class="card h-100">
      <div class="card-header bg-warning text-dark">
        <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Monthly P&L Forecast</h5>
      </div>
      <div class="card-body">
        <div class="chart-container">
          <canvas id="monthlyChart"></canvas>
        </div>
        <div class="card-footer mt-2"></div>
      </div>
    </div>
  </div>

  <!-- Weekly Forecast -->
  <div class="col-md-6">
    <div class="card h-100">
      <div class="card-header bg-info text-white">
        <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>7-Day Profit Forecast</h5>
      </div>
      <div class="card-body">
        <div class="chart-container">
          <canvas id="weeklyForecastChart"></canvas>
        </div>
        <div class="card-footer mt-2"></div>
      </div>
    </div>
  </div>

  <!-- Yearly Forecast -->
  <div class="col-md-6">
    <div class="card h-100">
      <div class="card-header bg-primary text-white">
        <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Yearly P&L Forecast</h5>
      </div>
      <div class="card-body">
        <div class="chart-container">
          <canvas id="yearlyChart"></canvas>
        </div>
        <div class="card-footer mt-2"></div>
      </div>
    </div>
  </div>

  <!-- AI Suggestions with Restaurant Theme -->
  <div class="col-md-6">
    <div class="card h-100">
      <div class="card-header bg-success text-white">
        <h5 class="mb-0"><i class="fas fa-robot me-2"></i>AI Chef Recommendations</h5>
      </div>
      <div class="card-body" style="max-height: 250px; overflow-y: auto;">
        <ul class="list-group list-group-flush">
          {% for s in ai_suggestions %}
          <li class="list-group-item bg-transparent text-light border-warning d-flex align-items-center">
            <span class="text-warning me-2">üçΩÔ∏è</span>
            {{ s }}
          </li>
          {% endfor %}
        </ul>
      </div>
      <div class="card-footer"></div>
    </div>
  </div>
</div>

<!-- Floating Action Button for Refresh (optional) -->
<div class="position-fixed bottom-0 end-0 m-4" style="z-index: 1000;">
  <button class="btn btn-warning rounded-circle p-3 shadow" onclick="location.reload()" 
          style="animation: glowPulse 2s infinite;">
    <i class="fas fa-sync-alt"></i>
  </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://kit.fontawesome.com/your-fontawesome-kit.js"></script>

<script>
// Chart animations with restaurant-themed colors
document.addEventListener('DOMContentLoaded', function() {
  
  /* ===== Monthly 3-Line Chart ===== */
  new Chart(document.getElementById("monthlyChart"), {
    type: "line",
    data: {
      labels: {{ monthly_labels | tojson }},
      datasets: [
        {
          label: "Revenue",
          data: {{ monthly_revenue | tojson }},
          borderColor: "#00ff99",
          backgroundColor: "rgba(0,255,153,0.1)",
          tension: 0.4,
          borderWidth: 3,
          pointRadius: 4,
          pointHoverRadius: 8,
          pointBackgroundColor: "#00ff99",
          borderDash: [5, 5],
          animation: {
            duration: 2000,
            easing: 'easeInOutQuart'
          }
        },
        {
          label: "Expense",
          data: {{ monthly_expense | tojson }},
          borderColor: "#ff4d4d",
          backgroundColor: "rgba(255,77,77,0.1)",
          tension: 0.4,
          borderWidth: 3,
          pointRadius: 4,
          pointHoverRadius: 8,
          pointBackgroundColor: "#ff4d4d",
          borderDash: [5, 5],
          animation: {
            duration: 2000,
            easing: 'easeInOutQuart'
          }
        },
        {
          label: "Net Profit",
          data: {{ monthly_profit | tojson }},
          borderColor: "#3399ff",
          backgroundColor: "rgba(51,153,255,0.1)",
          tension: 0.4,
          borderWidth: 3,
          pointRadius: 4,
          pointHoverRadius: 8,
          pointBackgroundColor: "#3399ff",
          borderDash: [5, 5],
          animation: {
            duration: 2000,
            easing: 'easeInOutQuart'
          }
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: { 
            color: '#ffd700',
            font: { 
              size: 11,
              weight: 'bold'
            }
          }
        },
        tooltip: {
          backgroundColor: 'rgba(0,0,0,0.9)',
          titleColor: '#ffd700',
          bodyColor: '#fff',
          borderColor: '#ffd700',
          borderWidth: 1
        }
      },
      scales: {
        x: { 
          ticks: { color: '#fff' },
          grid: { color: 'rgba(255,215,0,0.1)' }
        },
        y: { 
          ticks: { color: '#fff' },
          grid: { color: 'rgba(255,215,0,0.1)' }
        }
      }
    }
  });

  /* ===== Weekly Forecast ===== */
  new Chart(document.getElementById("weeklyForecastChart"), {
    type: "line",
    data: {
      labels: {{ weekly_labels | tojson }},
      datasets: [{
        label: "Daily Profit Forecast",
        data: {{ weekly_profit | tojson }},
        borderColor: "#ffaa00",
        backgroundColor: "rgba(255,170,0,0.2)",
        tension: 0.5,
        fill: true,
        borderWidth: 4,
        pointRadius: 5,
        pointHoverRadius: 10,
        pointBackgroundColor: "#ffaa00",
        pointBorderColor: "#fff",
        pointBorderWidth: 2,
        animation: {
          duration: 2000,
          easing: 'easeInOutQuart'
        }
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: { 
            color: '#ffd700',
            font: { 
              size: 11,
              weight: 'bold'
            }
          }
        },
        tooltip: {
          backgroundColor: 'rgba(0,0,0,0.9)',
          titleColor: '#ffd700',
          bodyColor: '#fff'
        }
      },
      scales: {
        x: { 
          ticks: { color: '#fff' },
          grid: { color: 'rgba(255,215,0,0.1)' }
        },
        y: { 
          ticks: { color: '#fff' },
          grid: { color: 'rgba(255,215,0,0.1)' }
        }
      }
    }
  });

  /* ===== Yearly Chart ===== */
  new Chart(document.getElementById("yearlyChart"), {
    type: "bar",
    data: {
      labels: {{ yearly_labels | tojson }},
      datasets: [{
        label: "Yearly Profit Forecast",
        data: {{ yearly_profit | tojson }},
        backgroundColor: "#ffd700",
        borderRadius: 8,
        barPercentage: 0.7,
        categoryPercentage: 0.8,
        animation: {
          duration: 2000,
          easing: 'easeInOutQuart'
        },
        hoverBackgroundColor: "#ffed4a"
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          labels: { 
            color: '#ffd700',
            font: { 
              size: 11,
              weight: 'bold'
            }
          }
        },
        tooltip: {
          backgroundColor: 'rgba(0,0,0,0.9)',
          titleColor: '#ffd700',
          bodyColor: '#fff'
        }
      },
      scales: {
        x: { 
          ticks: { color: '#fff' },
          grid: { color: 'rgba(255,215,0,0.1)' }
        },
        y: { 
          ticks: { color: '#fff' },
          grid: { color: 'rgba(255,215,0,0.1)' }
        }
      }
    }
  });
});
</script>

{% endblock %}